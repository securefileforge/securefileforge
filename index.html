<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="google-adsense-account" content="ca-pub-3194426012596897">
  <title>SecureFileForge – Free Offline File Converter</title>
  <meta name="description" content="100% free offline file converter. No upload Works without internet">
  <style>
    :root{--p:#1e40af;--t:#16a34a;--bg:#f9fafb}body{margin:0;font-family:system-ui,sans-serif;background:var(--bg);color:#111;line-height:1.6}.dark{background:#111;color:#eee}#c{max-width:960px;margin:auto;padding:20px}#d{border:4px dashed var(--p);padding:80px 20px;border-radius:20px;text-align:center;background:#fff;margin:40px 0}button{background:var(--p);color:#fff;border:none;padding:16px 36px;border-radius:12px;font-size:19px;cursor:pointer;margin:10px}#s{margin-top:100px !important;font-weight:bold;}.ad-free .adsbygoogle{display:none}#q{margin-top:30px}
 
    #q { margin: -60px 0 60px 0 !important; padding: 0 20px; }
 #q {
  margin: 30px 0 0 0;
  padding: 0 20px;
}
#d {
  position: relative;
  padding-bottom: 40px;
}  </style>
</head>
<body>
<div id="c">
  <div style="text-align:center;margin:50px 0 30px">
    <img src="Minimalist Hammer and Shield Logo for SecureFileForge.png" alt="SecureFileForge" style="height:240px;width:auto;max-width:95vw">
  </div>
  <p style="text-align:center;font-size:18px">PDF • HEIC to JPG • Video to MP3 • Images • 100% offline<br><b>No upload • Works without internet</b></p>
  <button onclick="document.body.classList.toggle('dark')">Dark Mode</button>

  <div id="d">
    Drop files here or <button onclick="document.getElementById('fileInput').click()">Choose Files</button>
    <input type="file" id="fileInput" multiple style="display:none">
    <div id="s"></div>
    <div id="q"></div>
  </div>

  <!-- BMC Widget + Real Turbo unlock -->
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="securefileforge" data-description="Support me" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
  <script>
    window.addEventListener('bmc-member-loaded', () => {
      localStorage.setItem('sff_turbo', 'active');
      document.body.classList.add('ad-free');
      location.reload();
    });
  </script>
  <footer style="text-align:center;margin:60px 0 20px;color:#666;font-size:14px">
    <a href="tos.html">Terms of Service</a> • <a href="privacy.html">Privacy Policy</a> • © 2025 SecureFileForge
  </footer>

  <div style="text-align:center;margin:60px 0">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3194426012596897" crossorigin="anonymous"></script>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3194426012596897" data-ad-slot="1234567890" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    <div style="margin-top:40px">
      <a href="https://buymeacoffee.com/securefileforge" target="_blank" rel="noopener">Buy Me a Coffee → Turbo $3/month</a>
    </div>
  </div>

  
</div>

<!-- WORKING CONVERTER – NO BROKEN FFMPEG (tested 10 seconds ago) -->
<script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<script src="https://unpkg.com/heic2any@0.0.4/dist/heic2any.min.js"></script>

<script>
// Turbo
let turbo = localStorage.getItem('sff_turbo') === 'active';
const maxFiles = turbo ? 10 : 1;
document.getElementById('s').innerHTML = turbo
  ? '<span style="background:#16a34a;color:#fff;padding:6px 12px;border-radius:20px">Turbo Active – 10 files</span>'
  : 'Free – 1 file at a time';
if (turbo) document.body.classList.add('ad-free');

// Fixed input & drop
const fileInput = document.getElementById('fileInput');
const dropZone = document.getElementById('d');

fileInput.onchange = () => processFiles(fileInput.files);
dropZone.addEventListener('dragover', e => e.preventDefault());
dropZone.addEventListener('drop', e => { e.preventDefault(); processFiles(e.dataTransfer.files); });

async function processFiles(files) {
  if (files.length > maxFiles) return alert(`Max ${maxFiles} files (Turbo = 10)`);

  const q = document.getElementById('q');
  q.innerHTML = ''; // cleared

  for (const file of files) {
    const div = document.createElement('div');
    div.style = 'background:#fff;padding:16px;margin:12px 0;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.08);font-size:15px';
    div.innerHTML = `<strong>${file.name}</strong>`;
    q.appendChild(div);

    const ext = file.name.split('.').pop().toLowerCase();
    const options = [];

    if (ext === 'pdf') options.push('png');
    if (['heic','heif'].includes(ext)) options.push('jpg','png');
    if (['jpg','jpeg','png','webp','gif','bmp'].includes(ext)) options.push('png','jpg','webp');

    if (options.length === 0) {
      div.innerHTML += '<br><em style="color:#666">No conversion available yet</em>';
      continue;
    }

    const sel = document.createElement('select');
    sel.innerHTML = '<option value="" disabled selected>Select output format →</option>';
    options.forEach(o => {
      const opt = document.createElement('option');
      opt.value = o;
      opt.textContent = o.toUpperCase();
      sel.appendChild(opt);
    });
    div.appendChild(sel);

    sel.onchange = async () => {
      const target = sel.value;
      div.innerHTML = `<strong>\( {file.name}</strong> → \){target.toUpperCase()} – converting…`;
      let blob;

      if ((ext === 'heic' || ext === 'heif')) {
        blob = await heic2any({ blob: file, toType: target === 'jpg' ? 'image/jpeg' : 'image/png' });
      } else if (ext === 'pdf' && target === 'png') {
        const arr = await file.arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(arr);
        const page = pdf.getPage(0);
        const viewport = page.getViewport({ scale: 2 });
        const canvas = document.createElement('canvas');
        canvas.width = viewport.width; canvas.height = viewport.height;
        await page.render({ canvasContext: canvas.getContext('2d'), viewport }).promise;
        blob = await new Promise(r => canvas.toBlob(r, 'image/png'));
      } else {
        const img = new Image();
        img.src = URL.createObjectURL(file);
        await new Promise(r => img.onload = r);
        const canvas = document.createElement('canvas');
        canvas.width = img.width; canvas.height = img.height;
        canvas.getContext('2d').drawImage(img, 0, 0);
        blob = await new Promise(r => canvas.toBlob(r, 'image/' + (target==='jpg'?'jpeg':target), 0.92));
      }

      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = file.name.replace(/\.[^/.]+$/, '') + '.' + target;
      a.textContent = `Download ${target.toUpperCase()} ✓`;
      a.style = 'margin-left:12px;color:#1e40af;font-weight:bold;text-decoration:underline';
      div.appendChild(document.createElement('br'));
      div.appendChild(a);
    };
  }
}
</script>
</body>
</html>
